# Fruit Classification using ViT Feature Extraction

![Python](https://img.shields.io/badge/Python-3.11-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-2.1-orange)
![Hugging Face](https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Transformers-yellow)
![License: MIT](https://img.shields.io/badge/License-MIT-green.svg)

This repository contains a Python notebook that demonstrates an effective approach to image classification by combining the power of a large pre-trained Vision Transformer (ViT) with classical machine learning models. Instead of fine-tuning a deep learning model, we use the ViT as a powerful feature extractor to convert fruit images into meaningful numerical vectors (embeddings) and then train lightweight classifiers on these features.

The project classifies images of fruits into 9 distinct categories.

## ğŸ Project Overview

The core idea is to leverage the rich visual understanding of a model pre-trained on millions of images without the need for extensive, resource-heavy training.

The workflow is as follows:
1.  **Data Loading**: Load fruit images and their corresponding labels from the dataset.
2.  **Feature Extraction**: Pass each image through the pre-trained **`google/vit-large-patch16-224-in21k`** model from Hugging Face to obtain a high-dimensional feature vector from the `[CLS]` token output.
3.  **Classifier Training**: Use the extracted feature vectors to train several standard machine learning classifiers from `scikit-learn`.
4.  **Evaluation**: Compare the performance of the classifiers on a validation set to identify the best-performing model.

## ğŸ“Š Dataset

This project uses the **[Fruit Detection YOLO](https://www.kaggle.com/datasets/ayush2051/fruit-detection-yolo)** dataset from Kaggle. The notebook is configured to read the YOLO-formatted labels to determine the class for each image.

The 9 fruit classes are:
`apple`, `avocado`, `banana`, `guava`, `kiwi`, `mango`, `orange`, `peach`, `pineapple`

## ğŸ† Results

The embeddings generated by the Vision Transformer proved to be highly effective features for this classification task. The performance of the different `scikit-learn` classifiers on the validation set is summarized below.

**Logistic Regression** achieved the highest accuracy, demonstrating that even a simple linear model can perform exceptionally well on top of powerful pre-computed features.

| Model                  | Validation Accuracy |
| :--------------------- | :------------------ |
| **LogisticRegression** | **0.9627**          |
| SVM (RBF)              | 0.9403              |
| RandomForest           | 0.9403              |
| GradientBoosting       | 0.9254              |

## ğŸš€ How to Run

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/azario0/fruit-classification-with-vit-features.git
    cd fruit-classification-with-vit-features
    ```

2.  **Install dependencies:**
    It's recommended to use a virtual environment.
    ```bash
    pip install -r requirements.txt
    ```
    *If a `requirements.txt` is not available, you can install the main libraries manually:*
    ```bash
    pip install torch transformers scikit-learn pandas pillow tqdm notebook
    ```

3.  **Download the dataset:**
    - Download the data from [Kaggle: Fruit Detection YOLO](https://www.kaggle.com/datasets/ayush2051/fruit-detection-yolo).
    - Unzip the file and place it in a `data/` directory. The final structure should look like this:

    ```
    .
    â”œâ”€â”€ notebook.ipynb
    â”œâ”€â”€ data/
    â”‚   â””â”€â”€ fruit-detection-dataset/
    â”‚       â”œâ”€â”€ images/
    â”‚       â”‚   â”œâ”€â”€ train/
    â”‚       â”‚   â””â”€â”€ val/
    â”‚       â””â”€â”€ labels/
    â”‚           â”œâ”€â”€ train/
    â”‚           â””â”€â”€ val/
    â””â”€â”€ README.md
    ```

4.  **Update the data path:**
    Open `notebook.ipynb` and ensure the `DATA_DIR` variable in the first cell points to the correct path:
    ```python
    # 1. CONFIG
    DATA_DIR = "data/fruit-detection-dataset/fruit-detection-dataset" # âœï¸ adjust if needed
    ```

5.  **Run the notebook:**
    Start Jupyter Notebook or JupyterLab and run the cells in `notebook.ipynb`.
    ```bash
    jupyter notebook
    ```

## ğŸ“œ License

This project is licensed under the MIT License. See the `LICENSE` file for more details.